<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:o="http://omnifaces.org/ui"
      xmlns:rich="http://richfaces.org/rich">
<h:head>
    <title>Kino - Rezerwuj</title>

    <style type="text/css">
        body {
            background-color: #575757;
        }

        #page-container {
            background-color: white;
            max-width: 1024px;
            height: 94vh;
            margin: 3vh auto;
            display: flex;
            flex-direction: column;
        }

        #go-back-button {
            margin-top: 20px;
            margin-left: 30px;
        }

        #room-plan-and-reservation-panel-container {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        #room-plan-panel {
            width: 70%;
            max-width: 600px;
            padding-left: 20px;
            padding-right: 20px;
        }

        #room-plan {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #screen {
            background-color: black;
            color: white;
            width: 90%;
            text-align: center;
            padding-top: 10px;
            padding-bottom: 10px;
            font-size: 16pt;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #seats-grid {
            padding-left: 10px;
        }

        #reservation-panel {
            width: 30%;
            padding-left: 20px;
            padding-right: 20px;
        }

    </style>
</h:head>
<h:body>
    <div id="page-container">
        <div id="main-container">
            <div id="go-back-button">
                <p:commandButton onclick="window.history.back();" value="PowrÃ³t do repertuaru"/>
            </div>
            <div id="room-plan-and-reservation-panel-container">
                <div id="room-plan-panel">
                    <h:form id="room-plan-form">
                        <h1 style="margin-bottom: 0px">#{reservationBean.screening.movieEntity.movieName}</h1>
                        <h2 style="margin-top: 0px">
                            <h:outputText value="#{reservationBean.screening.date}, ">
                            </h:outputText>
                            <h:outputText value="#{reservationBean.screening.time}">
                                <o:converter converterId="javax.faces.DateTime" pattern="HH:mm"
                                             timeZone="#{screeningsBean.timeZone}"/>
                            </h:outputText>
                        </h2>
                        <div id="room-plan">
                            <div id="screen">EKRAN</div>
                            <div id="seats-grid">
                                <rich:dataGrid value="#{reservationBean.iterationList}" var="seat"
                                               columns="#{reservationBean.columns}" elements="#{reservationBean.size}">
                                    <p:selectBooleanButton
                                            value="#{reservationBean.selectedSeatsList[seat]}"
                                            disabled="#{reservationBean.isReserved(seat)}" onLabel="" offLabel=""
                                            style="width:40px;margin-right:10px;">
                                        <p:ajax update=":room-plan-form:test"/>
                                    </p:selectBooleanButton>
                                </rich:dataGrid>
                                <h:panelGroup id="test">
                                    <ui:repeat value="#{reservationBean.selectedSeatsList}" var="myVar">
                                        <h:outputText value="#{myVar}, "/>
                                    </ui:repeat>
                                </h:panelGroup>
                            </div>
                        </div>

                    </h:form>
                </div>
                <div id="reservation-panel">
                    <h:form id="reservation-panel-form">
                        <h1>Rezerwuj</h1>
                        <b><h:outputLabel for="inputEmail" value="Podaj adres e-mail:"/></b>
                        <p:inputText id="inputEmail" style="margin-bottom: 10px;" value="#{reservationBean.email}"
                                     required="true"
                                     requiredMessage="Adres e-mail jest wymagany."
                                     validatorMessage="Niepoprawny adres e-mail.">
                            <f:validateRegex
                                    pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$"/>
                        </p:inputText>
                        <p:watermark for="inputEmail" value="E-mail"/>
                        <p:message for="inputEmail"/>
                        <p:commandButton value="Zarezerwuj" style="margin-top: 10px; margin-right: 10px;"
                                         action="#{reservationBean.makeReservation}"
                                         process="@form" update="@form"/>
                        <p:commandButton value="Kup" style="margin-top: 10px;" action="#{reservationBean.buyTickets}"
                                         process="@form" update="@form"/>
                    </h:form>
                </div>
            </div>
        </div>
    </div>
</h:body>
</html>
